#!/bin/bash

# ASCII banner

echo "    __               __                             "
echo "   / /_  ____ ______/ /_  ___  ____  __  ______ ___ "
echo "  / __ \/ __ `/ ___/ __ \/ _ \/ __ \/ / / / __ `__ \"
echo " / /_/ / /_/ (__  ) / / /  __/ / / / /_/ / / / / / /"
echo "/_.___/\__,_/____/_/ /_/\___/_/ /_/\__,_/_/ /_/ /_/ "
echo "       Bash Enumeration Script by wint3rmute        "                                            


# Prompt user for filename
read -p "Enter the filename to save the output (include .txt extension): " filename

# Perform system enumeration and save output to the specified file
{
  echo "----- System Enumeration Report -----"
  echo "Date: $(date)"
  echo "-------------------------------------"

  # Host information
  echo "### Host Information ###"
  hostnamectl

  # Kernel information
  echo "### Kernel Information ###"
  uname -a

  # Network information
  echo "### Network Information ###"
  ifconfig

  # Users and Groups
  echo "### Users and Groups ###"
  cat /etc/passwd
  cat /etc/group

  # Sudo rights
  echo "### Sudo Rights ###"
  sudo -l

  # Search for sensitive files containing passwords and SSH keys
  echo "### Searching for Sensitive Files (Passwords and SSH Keys) ###"
  grep -rEi 'password|pass|ssh_key' /etc

  # Check permissions on /etc/passwd, /etc/shadow, and /etc/sudoers
  echo "### Checking Permissions on /etc/passwd, /etc/shadow, and /etc/sudoers ###"
  ls -l /etc/passwd /etc/shadow /etc/sudoers

  # Search for configuration files
  echo "### Searching for Configuration Files ###"
  find /etc -name "*.conf" -type f

  # Check if user is in sudoers group
  echo "### Checking if User is in sudoers Group ###"
  groups $USER

  # Search for SUID and GUID binaries
  echo "### SUID and GUID Binaries ###"
  find / -type f \( -perm -4000 -o -perm -2000 \)

  # Internal ports
  echo "### Internal Ports ###"
  netstat -tuln

  # Processes running with root permissions
  echo "### Processes Running with Root Permissions ###"
  ps aux | grep "root"

  # List mounted filesystems
  echo "### Mounted Filesystems ###"
  df -h

  # List cronjobs
  echo "### Cronjobs ###"
  crontab -l

  echo "-------------------------------------"
} > "$filename"

echo "System enumeration completed. Output saved to $filename"

