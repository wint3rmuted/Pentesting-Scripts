 # a PowerShell script that lists all local users and their privileges, all local groups and their permissions, and all users with their group memberships (along with privileges) from the Active Directory domain

# List all local users and their privileges
$localUsers = Get-WmiObject -Class Win32_UserAccount | Where-Object { $_.Local -eq $true }

Write-Host "Local Users and Privileges:"
foreach ($user in $localUsers) {
    $userPrivileges = Get-WmiObject -Class Win32_UserAccount -Filter "Name='$($user.Name)'" | Select-Object -ExpandProperty Privileges
    Write-Host "$($user.Name) - Privileges: $($userPrivileges -join ', ')"
}

# List all local groups and their permissions
$localGroups = Get-LocalGroup

Write-Host "`nLocal Groups and Permissions:"
foreach ($group in $localGroups) {
    $groupMembers = Get-LocalGroupMember -Group $group.Name
    $groupPermissions = Get-LocalGroup -Name $group.Name | Select-Object -ExpandProperty Description
    Write-Host "$($group.Name) - Permissions: $($groupPermissions)"
    foreach ($member in $groupMembers) {
        Write-Host "   Member: $($member.Name)"
    }
}

# List all users in the Active Directory domain along with their privileges
$domainUsers = Get-ADUser -Filter * -Properties SamAccountName, MemberOf

Write-Host "`nActive Directory Users and Privileges:"
foreach ($user in $domainUsers) {
    $userPrivileges = $user.MemberOf | Get-ADGroup | Select-Object -ExpandProperty Name
    Write-Host "$($user.SamAccountName) - Privileges: $($userPrivileges -join ', ')"
}
