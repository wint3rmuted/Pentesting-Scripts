# A simple Ruby script that reads and prints local user information from /etc/passwd:

#!/usr/bin/env ruby

def enumerate_local_users
  # Check if the script is run with elevated privileges
  if Process.uid != 0
    puts "Please run the script with elevated privileges (sudo)."
    exit 1
  end

  # Read the content of the /etc/passwd file
  begin
    passwd_content = File.read('/etc/passwd')
  rescue StandardError => e
    puts "Error reading /etc/passwd: #{e.message}"
    exit 1
  end

  # Parse user information from the /etc/passwd content
  users = passwd_content.lines.map do |line|
    parts = line.split(':')
    {
      username: parts[0],
      uid: parts[2],
      gid: parts[3],
      home_directory: parts[5],
      shell: parts[6].chomp
    }
  end

  # Display the enumerated users
  puts "Enumerated Local Users:"
  users.each do |user|
    puts "Username: #{user[:username]}, UID: #{user[:uid]}, GID: #{user[:gid]}, Home: #{user[:home_directory]}, Shell: #{user[:shell]}"
  end
end

# Call the function to enumerate local users
enumerate_local_users

